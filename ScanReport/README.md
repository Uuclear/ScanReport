# 扫描报告处理工具

这是一个基于Python的扫描报告处理工具，可以批量处理PDF和图片文件，进行OCR识别，并按照特定格式重命名。

## 功能特点

- 批量选择PDF、PNG、JPG、JPEG文件
- 将PDF文件拆分为单页图片
- 在OCR识别前预先检测并校正图像方向
- 使用PaddleOCR进行高精度文字识别
- 支持两种格式的文件自动分类：
  - LIMIS格式: `[a-zA-Z]{2}\d{3}[-_—]\d{6}`（例如：AB123-456789）
  - 协会格式: `[a-zA-Z]{2}\d{2}[-_—]\d{9}`（例如：AB12-123456789）
- 按照正则表达式匹配结果自动分类到不同文件夹
- 智能文件夹管理：仅创建包含文件的文件夹
- 将同名文件合并为一个PDF
- 将所有处理后的文件导出为PDF格式，保持正确方向

## 系统要求

- Python 3.12.9
- 依赖库：tkinter, pdf2image, paddlepaddle, paddleocr, Pillow, PyPDF2, regex

## 安装步骤

1. 确保您已安装Python 3.12.9
2. 安装依赖库：
   ```
   pip install -r requirements.txt
   ```
3. 对于PDF处理，需要安装Poppler:
   - Windows: 从[这里](http://blog.alivate.com.au/poppler-windows/)下载，确保添加到PATH
   - macOS: 使用Homebrew安装 `brew install poppler`
   - Linux: 使用包管理器安装 `sudo apt install poppler-utils`

## 使用方法

1. 运行程序：
   ```
   python main.py
   ```
2. 点击"选择文件"按钮选择需要处理的文件
3. 点击"导出文件夹"按钮选择输出目录
4. 点击"批量处理"按钮开始处理文件
5. 如果需要中断处理，可以点击"停止"按钮
6. 处理完成后，可以点击"打开文件夹"按钮直接查看结果

## 输出结果

处理后的文件会自动分类到不同的文件夹：
- `Limis` 文件夹：包含匹配到LIMIS格式的文件
- `协会` 文件夹：包含匹配到协会格式的文件
- `其他` 文件夹：包含未匹配到任何格式的文件

如果某类格式没有匹配到任何文件，则不会创建对应的文件夹。

## 特殊处理能力

- **智能图像方向校正**：程序会在OCR识别前自动检测和校正图像方向，通过尝试不同的旋转角度并检测文本区域数量，找出最佳显示方向，确保最终PDF保持正确方向
- **空文件夹优化**：只创建实际包含文件的分类文件夹，避免生成空文件夹
- **失败恢复**：如果某张图片OCR识别失败，程序不会中断，而是将该文件归类到"其他"文件夹并继续处理
- **进度实时显示**：通过日志窗口可以实时查看每个文件的处理状态和识别结果

## 打包应用程序

可以使用Nuitka将程序打包为独立的可执行文件：

1. 安装Nuitka：
   ```
   pip install nuitka
   ```

2. 运行打包脚本：
   ```
   python build.py
   ```

3. 打包完成后，可执行文件将位于`dist`目录。

注意：打包过程可能需要一些时间，尤其是包含PaddleOCR等大型库的情况下。打包后的应用程序可以在没有Python环境的计算机上运行。

## 注意事项

- 首次运行时，PaddleOCR会自动下载模型文件，可能需要一些时间
- OCR识别速度取决于您的计算机性能和图片数量
- 处理过程中可以随时查看进度日志来了解处理状态
- 请确保已正确安装Poppler以支持PDF处理 